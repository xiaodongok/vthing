{"version":3,"file":"index.js","sources":["../core/input-number/index.ts"],"sourcesContent":["import type {ObjectDirective, VNode} from \"@vue/runtime-core\"\r\n\r\ninterface IVnode extends VNode {\r\n  inputLocking: boolean\r\n}\r\n\r\ntype InputElement = HTMLInputElement | HTMLTextAreaElement\r\n\r\nexport const inputNumber: ObjectDirective<HTMLInputElement | HTMLTextAreaElement> = {\r\n  created(el, binding, vnode) {\r\n    const iVnode = (vnode as IVnode)\r\n    let input = vnode.type === 'input' ? el : el.children.item(0) as InputElement;\r\n    if (input === null || input.tagName !== \"INPUT\") {\r\n      console.error(\"请在输入框中绑定\")\r\n      return;\r\n    }\r\n    input.addEventListener('compositionstart', () => {\r\n      iVnode.inputLocking = true\r\n    })\r\n    input.addEventListener('compositionend', () => {\r\n      iVnode.inputLocking = false\r\n      input?.dispatchEvent(new Event('input'))\r\n    })\r\n    input.addEventListener(\"input\", () => {\r\n      console.log(input.value)\r\n      if (iVnode.inputLocking || !input) {\r\n        return;\r\n      }\r\n      let oldValue = input.value;\r\n      let newValue = input.value;\r\n\r\n      newValue = newValue.replace(/\\D/g, '')\r\n      if(+newValue!==+oldValue){\r\n        input.value = newValue;\r\n        input.dispatchEvent(new Event(\"input\"))\r\n      }\r\n    })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAQa,MAAA,WAAW,GAA4D;AAClF,IAAA,OAAO,CAAC,EAAE,EAAE,OAAO,EAAE,KAAK,EAAA;QACxB,MAAM,MAAM,GAAI,KAAgB,CAAA;QAChC,IAAI,KAAK,GAAG,KAAK,CAAC,IAAI,KAAK,OAAO,GAAG,EAAE,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAiB,CAAC;QAC9E,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,CAAC,OAAO,KAAK,OAAO,EAAE;AAC/C,YAAA,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAA;YACzB,OAAO;AACR,SAAA;AACD,QAAA,KAAK,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,MAAK;AAC9C,YAAA,MAAM,CAAC,YAAY,GAAG,IAAI,CAAA;AAC5B,SAAC,CAAC,CAAA;AACF,QAAA,KAAK,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,MAAK;AAC5C,YAAA,MAAM,CAAC,YAAY,GAAG,KAAK,CAAA;YAC3B,KAAK,EAAE,aAAa,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAA;AAC1C,SAAC,CAAC,CAAA;AACF,QAAA,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAK;AACnC,YAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;AACxB,YAAA,IAAI,MAAM,CAAC,YAAY,IAAI,CAAC,KAAK,EAAE;gBACjC,OAAO;AACR,aAAA;AACD,YAAA,IAAI,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC;AAC3B,YAAA,IAAI,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC;YAE3B,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;AACtC,YAAA,IAAG,CAAC,QAAQ,KAAG,CAAC,QAAQ,EAAC;AACvB,gBAAA,KAAK,CAAC,KAAK,GAAG,QAAQ,CAAC;gBACvB,KAAK,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAA;AACxC,aAAA;AACH,SAAC,CAAC,CAAA;KACH;;;;;"}